# üö® –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ CUDA –ø—Ä–æ–±–ª–µ–º—ã

## –û—à–∏–±–∫–∞
```
FATAL: CUT_REQUIRE_CUDA=1 but torch.cuda.is_available() is False
```

## ‚ö° –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (2 –º–∏–Ω—É—Ç—ã)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ù–∞ GPU —Å–µ—Ä–≤–µ—Ä–µ –Ω–∞–ø—Ä—è–º—É—é

SSH –ø–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
# 1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd /workspace/aporto

# 2. –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏ (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —Ä–∞–∑)
chmod +x upscale/vastai_deployment/*.sh

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
bash upscale/vastai_deployment/fix_torch_cuda.sh

# 4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä
systemctl restart vast-upscale.service

# 5. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ (–¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å "CUDA OK")
tail -f /workspace/server.log
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –° –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã (—á–µ—Ä–µ–∑ SSH)

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã:

```bash
# –ù–∞ –≤–∞—à–µ–π –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
cd /Users/igortkachenko/Downloads/aporto  # –ø—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É

# –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ .env —É–∫–∞–∑–∞–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã SSH:
# GPU_SSH_HOST=your.gpu.server.com
# GPU_SSH_PORT=22
# GPU_SSH_USER=root

# –°–¥–µ–ª–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º (—Ç–æ–ª—å–∫–æ –ø–µ—Ä–≤—ã–π —Ä–∞–∑)
chmod +x fix_cuda_remote.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —É–¥–∞–ª–µ–Ω–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
./fix_cuda_remote.sh
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ GPU —Å–µ—Ä–≤–µ—Ä—É
- –ó–∞–ø—É—Å—Ç–∏—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ CUDA
- –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä
- –ü–æ–∫–∞–∂–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—Ö–∞

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –≤—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –≤ –ª–æ–≥–∞—Ö:
```
CUDA OK: {'torch_installed': True, 'cuda_available': True, ...}
```

## üîç –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É:**
   ```bash
   bash upscale/vastai_deployment/diagnose_cuda.sh
   ```

2. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥—É—é –≤–µ—Ä—Å–∏—é CUDA:**
   ```bash
   # –î–ª—è —Å—Ç–∞—Ä—ã—Ö GPU
   bash upscale/vastai_deployment/fix_torch_cuda.sh 11.8
   ```

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä–∞–π–≤–µ—Ä—ã NVIDIA:**
   ```bash
   nvidia-smi
   ```
   
   –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç - –ø—Ä–æ–±–ª–µ–º–∞ —Å –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ –∏–ª–∏ –≤—ã–±—Ä–∞–Ω –Ω–µ GPU instance –Ω–∞ Vast.ai.

## üìñ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–°–º. [CUDA_TROUBLESHOOTING.md](./CUDA_TROUBLESHOOTING.md) –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

## –ß—Ç–æ –¥–µ–ª–∞–µ—Ç fix_torch_cuda.sh?

1. ‚úÖ –£–¥–∞–ª—è–µ—Ç —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é PyTorch
2. ‚úÖ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç PyTorch 2.4.1 —Å CUDA 12.1
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å CUDA
4. ‚úÖ –¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Ä–∞–±–æ—Ç—É GPU

–°–∫—Ä–∏–ø—Ç –±–µ–∑–æ–ø–∞—Å–µ–Ω –∏ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑.
